<template>
    <v-app class="container white">

      <i> APPROVED AS MODIFIED May19, 2016 WIRB® </i>

      <h2> STUDY INFORMATION AND CONSENT TO RESEARCH </h2>


      TITLE:
      mPower (Mobile Parkinson Observatory for Worldwide, Evidenced-based Research)
      <br>
      PROTOCOL NO.:
      201410711
      WIRB® Protocol #20141369
      <br>

      SPONSOR:
      Sage Bionetworks
      INVESTIGATOR:
      Lara Mangravite, PhD
      1100 Fairview Avenue North Seattle, Washington 98109-4433 United States
      STUDY-RELATED PHONE NUMBER(S):
      <!--+1 206-667-2129 or toll-free at 844-822-4708-->
      
      <div id="A1" v-bind:class="highlightTracker.one ? 'highlighter': ''">
      <h2> OVERVIEW	</h2>
      <p> The purpose of this form is to help you decide if you want to join this research study. Please read the information carefully. </p>

      <h3><i> PURPOSE OF THE STUDY</i></h3>
      <p>You are invited to participate in a research study to understand variations in symptoms of Parkinson’s disease (PD). People with PD have different symptoms. These symptoms can change day-to-day and over time. This makes it hard to maintain quality of life and manage treatment. We would like to understand the reasons for these differences in symptoms of PD. The results of this study may help researchers develop new ways to manage PD symptoms.       
      This study uses an app to measure the symptoms of PD. If you participate in this study, we’ll ask you to complete surveys and perform brief activities while holding your phone. These activities use your phone’s built-in sensors to measure health symptoms. You can choose to connect the app to your fitness tracker (like the Apple Watch, FitBit, or Jawbone) if you wear one.</p>
      <h3><i> WHO CAN JOIN THIS STUDY?</i></h3>
      <p> If you are over 18 years old, you can join the study. We are looking for volunteers with PD and volunteers who do not have PD. Your participation in this study is entirely voluntary.                 
      To join this research study you must give your informed consent. Giving your informed consent means that you understand what the study is about and want to participate. If you decide to participate, you can withdraw your consent and leave the study at any time. </p>

      <h3><i> HOW LONG WILL I BE IN THE RESEARCH STUDY? </i></h3>
      <p>This phase of the study will last about one year. You can keep the app on your phone for as long as you choose. You can use it to track your symptoms and review your data.
      </p>

      <h3><i> HOW MANY PEOPLE WILL TAKE PART IN THIS STUDY? </i></h3>
      <p>We expect 20,000 people to join this study.</p>

      <h3><i> WHAT ELSE SHOULD I KEEP IN MIND? </i></h3>
      <p>First, participation is voluntary. Second, participating in a research study is not the same as receiving medical care. The decision to join or not join the research study will not affect your medical benefits.
      You should not join this research study until all of your questions are answered. If you join the study you will be given a copy of this form for your records.
      </p>

      </div>

      <div id="A2" v-bind:class="highlightTracker.two ? 'highlighter': ''">
      <h2> STUDY ACTIVITIES	</h2>
      <h3><i>What will you be asked to do?</i></h3>
      <p>If you decide to join the study, you will need to download the mPower study app on to your phone. The app is free from your phone’s app store. Then, you will need to register for the study.		
      After you register, we will ask you to answer survey questions on the app and to do simple activities while holding your phone. We might also send you notifications through the app. Your answers to the survey questions and the measurements from your 
      </p>
      <p>Here is more detail about what you will be asked to do:</p>
           
      <h3><i> Register to the study: </i></h3>
      <p> Follow the prompts on the app to register. First you will see an overview of the study and read about the risks and benefits of participating. You will confirm your decision to participate and sign this form directly on your phone. Then you will create your account. We will ask you to enter your name, email address, and other general information about yourself. You can cancel the registration process at any time.</p>
      
      <h3><i> Health Surveys: </i></h3>
      <p> We will ask you questions about your health and your medical history. We will ask if you have PD and if you take certain medications. Because the purpose of this study is to look for patterns over time, occasionally we will ask you to review and update your answers. We will also ask questions about your mood or how well you slept. </p>

      </div>

      <h3><i>Activities: </i></h3> <p>  We will ask you to do simple activities while holding your phone. For example: </p>
      <dl>
         <li>Say “aaah” into your phone’s microphone for 10 seconds. This is to measure variation in your voice. </li>
         <li> Walk and/or stand still with your phone in your pocket. This is to measure your gait and balance. Tap your fingers on your phone’s screen. This is to measure your speed and coordination. </li>
         <li> Play a short game. In this game, flowers light up in pattern. We ask you to tap the flowers in the same pattern. This is to test your short-term memory. </li>
         <li>Hold your phone. This is to measure tremor. </li>
          <li>You can choose to connect the app to your fitness tracker (like the Apple Watch, FitBit, or Jawbone) if you wear one. This is to measure how active you are. </li>
      </dl>

      <br>          
      <p> The activities should take you about 10 minutes. We will ask you to do the activities on certain days. You can participate any time during the day. If you would like a daily reminder, you can turn on notifications in the app to remind you to complete the activities and surveys. <p>          
      You can participate in all or only parts of the study. Completing the activities when we ask is very valuable for our study, but if you can’t, once a week still helps!  </p>
            
      <p> We ask that you use the app for 2 years for our study. But you can stop at any time. You can also keep using the app after the study is over. </p>
      </div>

      <div id="A3" v-bind:class="highlightTracker.three ? 'highlighter': ''">
      <h2> DATA COLLECTION, STORAGE, AND SHARING	</h2>

      <p>We will collect the following kinds of data from you:</p>
      <dl>
         <li>Survey data about your health and demographics</li>
         <li>Sensor data from your phone. Sensor data is data from your phone that you did not enter yourself.</li>
      </dl>
      
      <br>
      <p> We will store your data on a secure server, and assign you a participant ID number. </p>
      <p> We will share your de-identified data with other researchers in a database. If you do not want us to share this data, you can tell us. We will not share any data after that point, but we cannot withdraw data that has already been shared. </p>
      <p> If we share your data with other researchers, we will only share the participant ID. We will not share your name. </p>
      <p> We will NOT access other apps on your phone. Also, we will NOT access your contacts, photos, texts, or email. </p>
      
      <h3>
        AUTHORIZATION TO USE AND DISCLOSE INFORMATION FOR RESEARCH PURPOSES
      </h3>
           
      <p> We cannot use your personal information for this research without your written authorization. If you sign this consent form, you will provide this authorization. You will authorize the collection, processing, and transfer of your personal information for the purpose of this study. You do not have to sign this form. But if you do not, you will not be able to participate in this research study. </p>
      <h3>
      What personal information will be used or disclosed?					
      </h3>
      
      <p> Your personal information that may be collected, used, or disclosed for this research includes your: </p>
      <dl>
         <li>Height and weight </li>
         <li> Sex </li>
         <li> Age </li>
         <li> Ethnicity and race </li>
         <li> Answers to survey questions, including health history</li>
         <li> Activity data collected from your phone's sensors </li>
         <li> Any other information or comments your make through the app </li>
      </dl>

      <p> We may review your account information, study data, and signed consent form for regulatory compliance and /or quality assurance. </We>
					
      <p> We respect your privacy. We will never sell, rent, or lease your contact information. We will not disclose your personal information unless the law requires us to. Please read our Privacy Policy for more information (parkinsonmpower.org). </p>

      <h3><i> Who may use and disclose your Personal Information? </i></h3>
      <p> We may use and disclose your personal information to do this research. Our team includes the study sponsors , the investigators, the study coordinators, and study staff. We may also disclose your personal information as required by law. For example, we may be required to disclose your personal information to prevent possible injury to yourself or others. </p>
      
      <p> If required by law, we may disclose your information to: </p>
					
      <p> The US Department of Health and Human Services (HHS), the Office for Human Research Protection (OHRP), the Food and Drug Administration (FDA), and other agencies for review of our research procedures. </p>
                
      <p> Western Institutional Review Board® (WIRB®) or other Institutional Review Board (IRB) so they can monitor the safety, effectiveness, and conduct of our research. </p>
                
      <p> Others, if the law requires </p>

      <h3><i> When will my authorization expire? </i></h3>

      <p> Your authorization allows us to use and disclose your personal information for the purpose of this study. Your authorization will end if you withdraw from this study. If you do not withdraw, your authorization will end on December 31, 2060. Your authorization may end sooner depending on any time limitations imposed by law. </p>
					
      <p> If you withdraw from this study, we will stop collecting your study data. If you do not withdraw, we will stop collecting your data at the end of the study period. We will stop even if you keep using the app. </p>
                
      <p> If you were interested in joining another study, we would ask you to complete a new consent. The new consent will be like this one. It will explain the risks and benefits of the new study. </p>


    </div>








			

      <div v-if="!isModalFrame" class="attachButton">
        <v-btn flat v-on:click="overlay()" color="white" class=" largeButton mediumFontSize inheritPosition"> 
          <v-icon  class="defaultBlue" x-large> fa-expand </v-icon>
      </v-btn>
      </div>


    </v-app>
</template>

<script>
import _ from 'lodash'
import {highlightTracker} from '../../../state_objects/highlightTracker'
import {requirements} from '../../../state_objects/requirements'
export default {
  data () {
    return {
      highlightTracker: highlightTracker,
      requirements: requirements,
      showOverlay: false,
      isModalFrame: false
    }
  },
  computed: {
    keys: function () {
      return Object.keys(this.highlightTracker)
    },
    parentURL: function () {
      var url = (window.location !== window.parent.location)
        ? document.referrer
        : document.location.href
      return url
    }
  },
  methods: {
    // scroll to given ID coming in at a specific speed, the A is added because ID's have to start
    // with a letter
    scrollPage: _.debounce(
      function (arg1, speed) {
        arg1 = '#A' + arg1
        this.$scrollTo(arg1, speed, { easing: 'linear', offset: 0 })
      }
      , 200),
    // method to listen to events coming in
    recieveMessage: function (event) {
      if (event.origin !== 'http://web-mpower-2-michael.lee.s3-website-us-east-1.amazonaws.com') {
      // if (event.origin !== 'http://localhost:8080') {
        return ''
      } else {
        /* eslint-disable */
        if(event.data === "") {
          return ''
        }
        let index = event.data.indexInStack
        let forward = event.data.forward

        let keyCurrent = this.keys[index - 1]
        let keyBehind = this.keys[index - 2]
        // if it was called using 'Next' Button
        if (forward) {
          this.$set(this.highlightTracker,keyCurrent,true)
          this.$set(this.highlightTracker,keyBehind,false)
        } else {
          keyCurrent = this.keys[index]
          keyBehind = this.keys[index - 1]
          this.$set(this.highlightTracker,keyCurrent, false)
          this.$set(this.highlightTracker,keyBehind, true)
        }
        this.scrollPage(index, 1000)
        /* eslint-enable */
      }
    },
    // must keep state of what is being overlayed
    overlay () {
      this.showOverlay = !this.showOverlay
      window.parent.postMessage('switch overlay', this.parentURL)
    }
  },
  // if its the modal frame then on mount we need to scroll to the correct section
  created: function () {
    this.isModalFrame = window.frameElement.id === 'overlayFrame'
    if (!this.isModalFrame) { // with modal frame it will always scroll into sight below
      window.addEventListener('message', this.recieveMessage, false)
    }
  },
  // on mount must scroll to correct position if this is the modal, otherwise the frame will automatically
  // scroll
  mounted: function () {
    if (this.isModalFrame || this.highlightTracker.one) {
      let wordsToNums = [
        'one',
        'two',
        'three',
        'four',
        'five',
        'six',
        'seven',
        'eight',
        'nine',
        'ten',
        'eleven',
        'twelve',
        'thirteen'
      ]
      // here we parse the URL to know which location must be scrolled to on the page
      let href = window.parent.location.href
      href = href.split('Consent')
      let key = href[href.length - 1].toLowerCase()
      let index = wordsToNums.indexOf(key) + 1
      this.highlightTracker[key] = true
      this.$set(this.highlightTracker, key, true)
      this.$scrollTo(index, 0, { easing: 'linear', offset: 0 })
    }
  }
}
</script>

<style>

div {
  font-size: 18px;
}

p {
  color: black;
}

.highlighter {
  background-color: rgba(255, 218, 138, 0.7);

}

.normal {
  background-color: white !important;
}

.inheritPosition {
  position: inherit;
}

.defaultBlue {
    color: #3a539b !important;
}

/* if we put expand button within the iframe then it needs to have a z-index high enough
such that it can be reached by ConsentDoc and fire events */
.attachButton {
  z-index: 99999;
  position: fixed !important;
  bottom: 75px !important;
  right: 100px !important;
}

</style>
